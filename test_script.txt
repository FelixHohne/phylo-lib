#mod_use "tree.ml";;
#mod_use "dna.ml";;
#mod_use "clustal.ml";;
#mod_use "distance.ml";;
#mod_use "phylo_algo.ml";;

let d1 = Dna.from_fasta "FASTA/example_2.fasta";;
let d2 = Dna.from_fasta "FASTA/example_3.fasta";;
let d3 = Dna.from_fasta "FASTA/example_4.fasta";;
let d4 = Dna.from_fasta "FASTA/example_5.fasta";;
let d5 = Dna.from_fasta "FASTA/example_6.fasta";;
let aligned = Msa.align [|d1; d2; d3; d4; d4;|]
let mat = Distance.dist_msa aligned 1;;
let mat2 = Distance.dist_dna [|d1; d2; d3; d4; d4;|] 1 (-1) (-1);;

Phylo_algo.upgma mat [|"A"; "B"; "D"; "E"; "F"|] |> Tree.print_tree;;

Phylo_algo.upgma mat2 [|"A"; "B"; "D"; "E"; "F"|] |> Tree.print_tree;;

let d1 = Dna.from_fasta "viruses/full_sars.fasta";;
let d2 = Dna.from_fasta "viruses/h1n1.fasta";;
let d3 = Dna.from_fasta "viruses/h3n2.fasta";;
let mat = Distance.dist_dna [| d1; d2; d3 |] 1 (-1) (-1);;
Phylo_algo.upgma mat [|"SARS"; "H1N1"; "H3N2"|] |> Tree.print_tree;;


